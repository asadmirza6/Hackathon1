# Phase 1: Data Model

**Status**: Complete | **Date**: 2025-12-09

This document defines the core entities, relationships, and validation rules for the Docusaurus book project.

---

## Entity: Chapter

**Purpose**: Logical grouping of 2 lessons in the course structure.

**Fields**:
| Field | Type | Required | Constraint | Description |
|-------|------|----------|-----------|-------------|
| `id` | string | Yes | 1-4 | Chapter identifier (chapter-1, chapter-2, chapter-3, chapter-4) |
| `number` | integer | Yes | 1-4 | Numeric order for display |
| `title` | string | Yes | 1-100 chars | Chapter title (e.g., "Physical AI Foundations") |
| `description` | string | Yes | 10-200 chars | Short description for course outline |
| `lessons` | Lesson[] | Yes | Exactly 2 | Array of 2 lesson objects |

**Relationships**:
- Has many: `Lesson` (exactly 2 required)
- Sidebar navigation references chapters as category groups

**Validation Rules**:
- `id` must match pattern `chapter-[1-4]`
- `number` must be unique (1, 2, 3, 4)
- `title` must be non-empty
- `lessons` array must contain exactly 2 lesson objects
- All chapter data is immutable (cannot be added, removed, or reordered)

**State Machine**:
```
CREATED (immutable) → RENDERED (navigation + search indexed)
```

---

## Entity: Lesson

**Purpose**: Individual learning unit with markdown content and metadata.

**Fields**:
| Field | Type | Required | Constraint | Description |
|-------|------|----------|-----------|-------------|
| `id` | string | Yes | Unique | Lesson identifier (lesson-1 or lesson-2) |
| `chapter_id` | string | Yes | 1-4 | Parent chapter reference |
| `position` | integer | Yes | 1-2 | Position within chapter (1 = first, 2 = second) |
| `title` | string | Yes | 1-200 chars | Lesson title |
| `description` | string | Yes | 10-300 chars | Short summary for SEO/search |
| `keywords` | string[] | Yes | 1-10 tags | Search keywords and topics |
| `content` | string | Yes | 1000+ chars | Full markdown content |
| `word_count` | integer | Calculated | 3000-5000 | Content length metric |
| `file_path` | string | Calculated | Valid path | Location: `docs/chapter-N/lesson-M.md` |

**Relationships**:
- Belongs to: `Chapter` (parent)
- Referenced by: `SearchIndex` (indexed for full-text search)

**Validation Rules**:
- `id` must match pattern `lesson-[1-2]`
- `position` must be 1 or 2 (exactly 2 lessons per chapter)
- `title` must be non-empty and descriptive
- `keywords` array must have 1-10 items
- `content` must be valid markdown
- File path must resolve to `book/docs/chapter-[1-4]/lesson-[1-2].md`
- YAML frontmatter must include: title, description, keywords, sidebar_position

**Frontmatter Schema**:
```yaml
---
title: Lesson Title
description: Short description for search/SEO
keywords: [tag1, tag2, tag3]
sidebar_position: 1
---
```

**State Machine**:
```
CREATED (markdown file)
  ↓
INDEXED (search engine indexes content)
  ↓
RENDERED (HTML displayed on website)
  ↓
QUERYABLE (searchable via search box)
```

---

## Entity: SearchIndex

**Purpose**: Full-text index of all lesson content for discovery.

**Fields**:
| Field | Type | Generated By | Purpose |
|-------|------|-------------|---------|
| `doc_id` | string | Docusaurus | Unique document identifier (e.g., `chapter-1/lesson-1`) |
| `title` | string | Lesson metadata | Lesson title (high weight in ranking) |
| `content` | string | Lesson markdown | Full content body (medium weight) |
| `keywords` | string[] | Lesson metadata | Search tags (high weight) |
| `url` | string | Build process | Path to lesson page (e.g., `/docs/chapter-1/lesson-1`) |
| `timestamp` | ISO-8601 | Build process | Index generation time |

**Generation**:
- Created automatically during Docusaurus build
- Triggered by `@docusaurus/plugin-search-local`
- Updates on every build (full reindex)
- Stored as JSON blob in built site

**Query Contract**:
- Input: Search query string (keywords, phrases)
- Output: Ranked list of matching lessons with relevance scores
- Response time: <500ms (client-side)

**Indexing Rules**:
- Include lesson title, keywords, and markdown content
- Exclude YAML frontmatter, code block syntax, HTML tags
- Case-insensitive matching
- Support partial word matching (e.g., "robot" matches "robotics")

---

## Entity: Navigation

**Purpose**: Sidebar navigation structure for lesson discovery.

**Structure** (hardcoded in `sidebars.ts`):
```
Chapter 1: Physical AI Foundations
  ├── Lesson 1: Physical AI Basics
  └── Lesson 2: Humanoid Robotics Overview

Chapter 2: Control & Hardware
  ├── Lesson 1: Control Systems
  └── Lesson 2: Sensors & Actuators

Chapter 3: Mechanical Design & Motion
  ├── Lesson 1: Humanoid Mechanical Design
  └── Lesson 2: Locomotion & Planning

Chapter 4: Human-AI Collaboration
  ├── Lesson 1: Human-AI Interaction
  └── Lesson 2: Future of Physical AI
```

**Metadata**:
| Field | Type | Value |
|-------|------|-------|
| `total_chapters` | integer | 4 |
| `lessons_per_chapter` | integer | 2 |
| `total_lessons` | integer | 8 |
| `structure_immutable` | boolean | true |

**Sidebar Navigation Rules**:
- Chapters must appear in order (1 → 2 → 3 → 4)
- Lessons must appear in order within chapter (1 → 2)
- Each chapter shows exactly 2 lessons (never 1, never 3)
- Active/current lesson is highlighted in sidebar
- Links are clickable and navigate to lesson page
- Structure is immutable (cannot add/remove chapters or lessons)

---

## Relationships

```
┌─────────────┐
│   Chapter   │  (4 total, immutable)
└──────┬──────┘
       │ has 2
       └─────────────┬──────────────┐
                     ▼              ▼
            ┌──────────────┐  ┌──────────────┐
            │   Lesson 1   │  │   Lesson 2   │
            └──────┬───────┘  └──────┬───────┘
                   │                 │
                   └────────┬────────┘
                            ▼
                  ┌──────────────────┐
                  │  Search Index    │
                  │  (auto-generated)│
                  └──────────────────┘
                            │
                            ▼
                  ┌──────────────────┐
                  │  Navigation Bar  │
                  │  (sidebar)       │
                  └──────────────────┘
```

---

## Constraints & Invariants

1. **Immutable Structure**: The 4×2 lesson structure cannot be changed at runtime
2. **Consistent Metadata**: All lessons must have complete YAML frontmatter
3. **Unique Identifiers**: No duplicate chapter or lesson IDs
4. **Valid Paths**: All lesson files must exist at expected locations
5. **Content Quality**: Each lesson must be 3000-5000 words
6. **Search Coverage**: All lesson content must be indexed (no exclusions)

---

## Validation Checklist

- [ ] All 4 chapters exist with correct titles and descriptions
- [ ] Each chapter has exactly 2 lessons
- [ ] All 8 lesson files are present with correct YAML frontmatter
- [ ] All lesson paths follow `docs/chapter-N/lesson-M.md` pattern
- [ ] No duplicate chapter or lesson IDs
- [ ] All lesson titles are unique and descriptive
- [ ] Keyword arrays have 3-10 relevant terms per lesson
- [ ] Content is valid markdown with no syntax errors
- [ ] Search index is generated during build without errors
- [ ] Navigation sidebar displays all 4 chapters with 2 lessons each
- [ ] Active lesson highlighting works in sidebar
- [ ] Deep links (`/docs/chapter-N/lesson-M`) resolve correctly

---

## Next Steps

This data model is fully realized in the current codebase:
- ✅ All 8 lesson markdown files exist with proper structure
- ✅ YAML frontmatter is complete and consistent
- ✅ Chapter directory structure matches specification
- ✅ Search plugin will auto-generate index during build
- ⏳ Sidebar navigation (sidebars.ts) needs to be created in Phase 1 implementation
